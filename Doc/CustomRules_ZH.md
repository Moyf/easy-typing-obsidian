# 自定义转换规则

Easy Typing 插件支持用户自定义转换规则，以满足个性化的编辑需求。

## 使用方法

1. 在插件设置中找到自定义转换规则部分
2. 根据需要添加相应类型的规则
3. 规则会在编辑过程中自动生效

## 规则类型

### 1. 选中文本时的转换规则

当选中文本并输入特定触发符号时，将文本转换为指定格式。

格式：`触发符号,左侧字符串,右侧字符串`

例如：`-,~~,~~` 表示选中文本后输入 `-`，会将文本转换为 `~~选中的文本~~`

### 2. 删除时的转换规则

在使用退格键删除文本时，将特定格式的文本转换为其他格式。

匹配删除前文本格式：`光标前文本|光标后文本`
匹配删除后文本格式：`光标前文本|光标后文本`

例如：删除前：`<|>`，删除后：`|` 表示当光标在 `<>` 之间时，按退格键会删除整个 `<>`

更多例子：

- 删除前：`- [ ] |`，删除后：`- |` 表示当光标在 `- [ ]` 之后时，按退格键会删除整个 `[ ]`，实际效果是删除空task项时，会变成列表项。

### 3. 输入时的转换规则

在输入特定字符序列时，自动将其转换为其他格式。

匹配转换前文本模式：`光标前文本|光标后文本`
匹配转换后文本模式：`光标前文本|光标后文本`
例如：转换前：`:)|`，转换后：`😀|`， 表示输入 `:)` 时会自动转换为笑脸表情 😀，光标位于表情符号后面


## 自定义转换、删除规则的语法

- 使用 `|` 来表示光标位置
- 删除规则和输入规则支持正则表达式匹配，格式为 `r/光标前正则表达式/|r/光标后正则表达式/`
- 转换后的文本中可以使用 `[[n]]` 来引用正则表达式捕获的匹配组内容，以0开始的数字表示匹配组，`[[0]]` 表示第一个匹配组，`[[1]]` 表示第二个匹配组，以此类推。
  - 注意：`[[n]]` 仅在转换后文本中有效
  - 对于 光标后正则表达式 匹配的第 m 组内容，设置为 `[[m+n-1]]`，n 为光标前正则表达式匹配的组的数量。
- 可以使用 `$n` (n 为数字)来表示多光标位置，`$0` 表示第一个光标位置，`$1` 表示第二个光标位置，以此类推。
  - 可以使用 `${n: 文本}` 来表示文本被选中
  - 多光标的情况下，在规则生效后，按 Tab 键可以在多个光标位置之间切换。
  - 注意：`$n` 仅在转换后文本中有效

## 高级用法

### 多光标和正则表达式转换规则示例

例子1：自定义转换规则： 匹配 `r/(?<=^|\n)([\w-]+)-call/|`， 转换成 `> [![[0]]] $0\n> $1`，即可实现在行首输入 `note-call`，即可转换成
```
> [!note] $0
> $1
```
其中， $0, $1 表示不同的两个光标，可以通过 Tab 键从 $0 跳转到 $1
![](/assets/multi-cursor.gif)

例子2： 匹配 `r/t_(\d|i)/|`，转换成 `$t_{[[0]]}$`，即可实现在行内输入 `t_1` 时，转换成 `$t_{1}$`

例子3：自定义删除规则，转换前：`r/ ?!?\[\[[^\n\[\]]*\]\]/|`，转换后：`|`，即可实现一键删除光标前的双链 `[[双链内容]]`。
