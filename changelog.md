## 更新日志 Changelog
- V4.0.5 2022.04.06
  - Improvement
    - 全角字符增强功能：增加了中文括号、书名号、引号的自动配对输入。
    - 优化了插件设置面板
- V4.0.4 2022.03.27
  - Bug fix
    - 修复在 Ubuntu 下，全角增强开启下两次`：`不会变成`:`的 bug。
- V4.0.3 2022.03.27
  - New Feature
    - 新增了行模式：只在一行输入结束，回车创建新行的时候，对该行进行格式化。可以在插件设置中打开(Add LineMode: Only formatting when line end. need to be activated in setting pane)
  - Improvement
    - 增加了格式化全文的命令（add command to foramt the whole article）
    - format-selection 命令在没有选中文本的情况下，格式化当前行。（format-selection command will format current line when there is no selection）
  - Bug fix
    - 修复了链接后面错误添加空格的 bug。（fix bug: sometime it mistakenly add space after link）
    - 修复全角增强功能在 linux 下两次 `；`不会转换成 `;` 的 bug
  - Others
    - 建议在插件设置中的正则表达式设置中添加两行正则: 
      - `\[\!.*?\][+-]{0,1}` 用于排除对 Obsidian 0.14 版本后新增的 callout 类型的格式化 
      - `<.*?>` 用于排除 Templater 插件特定语法的格式化。
- V4.0.1 2022.02.21
  - Improvement
    - 全角字符增强，增加了对Mac系统下两次中文竖线变英文竖线的功能 #24
    - 全角字符增强，调整增强了对 》 以及 $ 的操作
- V4.0.0 2022.02.09 
    - Improvement
        - **同时支持 live preview 模式 (Support Live preview) 和 legacy editor**
        - 优化文本解析的时机和解析的范围，提升性能；在切换文档的时候重新解析文档。
        - 支持 Admonition 代码块内部文本自动格式化
        - 增加命令：格式化选中的文本
        - 增强了 `链接与文本智能空格` 的功能
        - 大大增强了 `全角字符输入增强/辅助` 功能
        - 回车后，对上一行文本进行格式化
    - Bug fix
        - 解决了某些情况下，格式化行时最终光标计算错误的 Bug。
        - 修复了解析全文时，在某些情况下在全文最后会多计算一行 undefined 的 Bug

---
- v3.4.3 2021.11.18
  - Bug fix
    - fix that two successive `：` will be converted to `:` not working in ubuntu;
- v3.4.2 2021.11.18
  - New feature
    - Add new feature to full-width symbol enhancement. Two successive `：` will be converted to `:`; two successive `》` will be converted to `>`; two successive `。` will be converted to `.`; two successive `、` will be converted to `/`; two successive `（` will be converted to `()`, and the cursor will be in the middle. It only works when you input, and it won't affect the existing context. 为全角符号增强添加新功能。 两个连续的`：`将被转换为`:`； 两个连续的`》`将被转换为`>`； 两个连续的`。`将被转换为`.`； 两个连续的`、`将被转换为`/`； 两个连续的`（`会被转换成`()`，光标会在中间。该功能只在你输入的时候触发，不会影响已经存在的文本。
- v3.4.1 2021.11.17
  - Improvement
    - Be compatible with plugins: Obsidian Emoji Shortcodes. 与插件 Obsidian Emoji Shortcodes 兼容。
- v3.4.0 2021.10.23
  - New feature
    - 全角字符增强功能增加了行首的`》`自动转换成`>`，行首的`、`自动转换成`/`（为了配合核心插件slash commands）。The full-width character enhancement has new feature: The `》` at the beginning of the line is automatically converted to `>`, and the `and` at the beginning of the line are automatically converted to `/` (in order to cooperate with the core plug-in slash commands) #17
  - Bug fix
    - 修复了鼠标点击到新的空白行首再输入时，句首字母大写失效的问题。Fixed an issue where capitalizing the first letter of a sentence would not work when clicking on the beginning of a blank line
- v3.3.5 2021.10.20
  - Bug fix
    - Try to fix #17 which happened on MacOS: 2 `￥` can't convert to `$$`。
- v3.3.4 2021.9.29
  - Improvement
    - 提升了对链接的识别，不带`https://` 的 www.开头的链接也能识别。Enhance the recognization for link, link not begin with `https://` but begin with `www.` can be recognized.
  - Changes
    - 全角字符增强的功能不再将中文省略号（中文输入法下`shift+6`）自动转化成`^`。The enhanced function of full-width characters no longer automatically converts Chinese ellipsis (`shift+6` under Chinese input method) into `^`.
- v3.3.3 2021.6.22
  - Change
    - 移除了分号后面的首字母大写，英文用法中分号后面不用大写。Remove capitalization after ";", for I had midsunderstood the use of ";" in English.
- v3.3.2 2021.6.20
  - bug fix
    - 修复了首字母大写在某些情况失效的bug. Fixed a bug where initial capitalization failed in some cases.
- v3.3.0 2021.6.19
  - Shinny new things
    - 首字母大写可撤销 Feature of capitalizing the first letter of every sentence is revocable now.
    - 增加了[[wikilink]]的智能空格选项，可以根据其上下文决定是否加空格。 Add setting for smart spacing for [[wikilink]], which decide whether to add spaces from the context.
  - Bug fix
    - 解决了之前格式化一行文本的命令不生效的bug。Fixed a bug where formatting a line of text doesn't work
- v3.2.2 2021.6.16
  - Improvement
    - 增加了对错误的自定义正则的处理，修复了空字符串的正则导致软件卡死的bug, 正则表达式功能应该没问题了。
    - 修改了formatLine的方式，只对一行中需要格式化的部分进行replaceRange，解决了一行中如果有%`-时每次格式化都需要重新解析全文的问题，提升了性能。
    - 全角字符增强的功能增加了输入……（shift+6）转换为^的功能。issue #10.
    - 修改了很多if-else，改成switch，略微提升性能
- v3.2.1 2021.6.10
  - Improvement
    - 增加了连续三次键入·，会变成\`\`\`
- v3.2.0 2021.6.10
  - Shiny new things
    - 增加了用户自定义正则表达式的功能，对正则表达式选取的部分不进行格式化。如`:\w*:`将识别emoji，并不会格式化其内部。`{{.*?}}`将识别双花括号部分，并对其内部不格式化。
    - 还可以选择自定义区块和其他文本区块之间空格。
  - Change
    - 合并了之前的 wikilink, mdlink, barelink，统称为link，相关的自动空格开关也合并为1个。
  - Others
    - 部分代码重新命名/注释，更加清晰
- v3.1.9 2021.6.9
  - Bug fix
    - 修复 v3.1.8 全角输入增强对 Mac 版本 obsidian无效的问题
- v3.1.8 2021.6.9
  - Improvement
    - 增加了全角符号输入增强，现在连续两个￥￥会变成$$，并将光标定位到中间，输入两个【会变成`[[cursor]]`，同理输入两个`·`会变成\`cursor\`
    - 重写了splitLine函数，改善逻辑，增加可维护性，并支持行内`$$block formula$$`的识别。  
    - readme 增加了对插件设置面板的说明
- v3.1.7 2021.6.7
  - Improvement
    - selectFormat 增加了选中文本时按【则在文本两边增加`[]`的效果.
    - 现在选中文本再【或者￥后，文本还保持选中
    - list或者task内部开头的整行公式(如`$$x+y=z$$`)现在也能被识别，不会导致错误的格式化。
- v3.1.6 2021.5.28
  - Improvement
    - 在设置项增加了Debug，可以在控制台输出调试信息，方便调试。
  - Bug fix
    - 修复光标定位新行时，prevCursor没更新导致的bug。
- v3.1.5 2021.5.28
  - Bug fix
    - 修复了在text类型的行编辑后，光标定位到codeblock内编辑情况下，format会对codeblock起作用的bug。
- v3.1.4 2021.5.26
  - Improvement
    - Reduce computatio: 不再在每次按键输入时解析全文，分析段的类型，而是在文本行数变化，或者在本文增减 `$- 这几个符号的时候重新解析全文的行类型。 
    - Effect change: 修改了数字空格选项的逻辑，不再在数字与字母之间空格。
  - Bugs fix
    - set `manifest.json`: `"isDesktopOnly": true`, Since I'm using the CodeMirror 5 API
    - remove unused imports
    - unhook events in `onunload()`
- v3.1.3 2021.5.16
  - bug fix
    - [x] 修复了标题首字母大写不生效的bug
    - [x] 修复了`[https://xxx]()` mdlink中方括号内部两边会自动生成空格的问题。 
- v3.1.2 2021.5.16
  - bug fix
    - [x] 文本和inline元素之间打空格回多添加一个空格, that won't happen again.
- v3.1.1 2021.5.15
  - Improve
  	- [x] 选中文本情况下，按中文的￥键，将自动替换成$，变成行内公式
  	- [x] 选中文本情况下，按中文的·，将自动替换成`，变成行内代码块
- v3.1.0 2021.5.14
  - Improve
    - **增加了全文的内容识别，在全文语境下的代码块和公式中不自动格式化**
    - 增加了快捷键：全文格式化
    - 增加了快捷键：AutoFormat 开关切换
    - Md 链接将不论小括号内容
- v3.0.1
  - bug fix
    - 修复了inline code 等元素和前后的标点符号空格的bug。
- v3.0.0
  - Improvement
    - **重构代码逻辑**，提升可维护性
    - 增强了行内公式和行内代码块的识别逻辑
    - 增加了多种链接的识别：wiki link, markdown link and bare link.
    - 增加了多种链接的自动空格功能开关
    - 开发了**光标位置计算算法**，大大提升了行内编辑的体验
- v2.3.1
  - bug fix
    - [x] 修复数字和后面的冒号自动空格的 bug
- v2.3.0
  - improvement
    - 增加了对obsidian 和 zotero 链接的识别（`obsidian://`, `zotero://`），链接内部不自动 format
  - Bug fix
    - 修复了对部分链接内部字符无法识别的bug
- v2.2.0
  - improvement
    - 去除部分冗余代码
    - 对main.ts中类重新命名
- v2.1.0
  - bugs fix    
    - 修复上个版本中链接在某些情况下还是会被格式化的bug
- v2.0.0
  - Improvement
    - 独立设置数字和英文文本，标点的空格，数字和`.`不空格
    - list，checkbox 中支持英文行首字母大写
    - 自动识别网址链接，不格式化网址链接部分内容
    - 识别 WikiLink 和 MarkDown link，不格式化其内容
    - 设置面板分类更加清晰
  - Bug fix
    - inline 元素的范围识别逻辑
- v1.0.0
  - 基本功能完成